#!/usr/bin/env ruby

PAK_PATH = File.expand_path('../../lib', __FILE__)

require "thor"
require "pakyow/commands/console"
require "pakyow/commands/server"
require "generators/pakyow/app/app_generator"

module Pakyow
  class CommandLineInterface < Thor
    desc "new DESTINATION", File.read(File.join(PAK_PATH, "commands/USAGE-NEW"))
    def new(destination)
      ARGV.shift
      Pakyow::Generators::AppGenerator.start
    end

    desc "console ENVIRONMENT", File.read(File.join(PAK_PATH, "commands/USAGE-CONSOLE"))
    def console(environment = :development)
      Pakyow::Commands::Console
        .new(environment: environment)
        .run
    end

    desc "server ENVIRONMENT", File.read(File.join(PAK_PATH, "commands/USAGE-SERVER"))
    option :port, type: :numeric, aliases: :p, default: 3000
    def server(environment = :development)
      Pakyow::Commands::Server
        .new(environment: environment, port: options[:port])
        .run
    end
  end
end

Pakyow::CommandLineInterface.start
